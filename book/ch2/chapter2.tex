\S \textbf{2.1. Точное решение }

Существует единственный индекс $k = 0$, когда интеграл (5) берется в элемен-
тарных функциях. Делая в интеграле (5) замену переменных $\tau = \exp{t}$, легко получаем
\begin{equation}
I_0(x) = ln(1+e^{x}).
\label{eq:ref21}
\end{equation}
Для этой функции выполняется важное соотношение, связывающее функцию положительного и отрицательного аргументов:
\begin{equation}
I_0(x) = I_0(-x) + x, x > 0.
\label{eq:ref22}
\end{equation}
В его справедливости нетрудно убедиться, подставляя \ref{eq:ref21} в \ref{eq:ref22}.
\newline
\indent
Из \ref{eq:ref21} нетрудно получить асимптотическое поведение это функции: $I_0(x)~=e^{x}$ при $ x \to -\infty$, $I_0(x)~= x$ при $x \to +\infty$. Видно, что левая и правая асимптоты качественно отличаются друг от друга.
\newline
\indent
Все прочие функции ФД при $k != 0$ в элементрных функциях не выражаются. Для них необходимо разрабатывать алгоритмы, имеющие хорошую точность и экономичность. Эти алгоритмы основываются на различных свойствах функций ФД. Поэтому рассмотрим их основные свойства.
\newline
\indent
\newline
\S \textbf{2.2 Связь функций соседних индексов}

Пусть $k > 0$. Вычислим производную функции ФД, дифференцируя (1) по $х$:
\begin{equation}
I_{k}^{'}(x) = \int_0^{\infty} \frac{d}{dx}\bigg(\frac{1}{1+\exp{(t-x)}}\bigg)t^{k}dt
\end{equation}
Поскольку дробь в скобках зависит только от выражения $t - x$, то
дифференцирование этой дроби по $x$ эквивалентно дифференцированию этой
дроби по $t$ со знаком "минус":
\begin{equation}
I_{k}^{'}(x) = -\int_0^{\infty} \frac{d}{dt}\bigg(\frac{1}{1+\exp{(t-x)}}\bigg)t^{k}dt
\end{equation}
Берем получившийся интеграл по частям:
\begin{equation}
I_{k}^{'}(x) = -\frac{t^{k}}{1+exp{(t-x)}}\bigg|_0^{\infty} + \int_0^{\infty} \frac{d}{dt}(t^k)\frac{dt}{1+exp{(t-x)}}
\end{equation}
Поскольку $k > 0$, выражение перед интегралом обращается в нуль при $t = 0$ и
при $t \to +\infty$. Раскрывая в последнем интеграле $d/dt$, получим:
\begin{equation}
I_{k}^{'}(x) = k\int_0^{\infty} \frac{t^{k-1}dt}{1+\exp{(t-x)}}dt = kI_{k-1}(x)
\label{eq:ref23}
\end{equation}
Это соотношение связывает производную функции ФД с функцией ФД на
единицу меньшего индекса.

Соотношение \ref{eq:ref23} было получено для $k > 0$; при этом в правой части стоит
функция с индексом больше $-1$. Будем считать это соотношение справедливым
для любых значений $k$. Тогда оно доопределяет функции ФД нецелых индексов
$k < -1$: оно выражает эти функции через производные функции ФД на единицу
большего индекса. Очевидно, для получения функции ФД с индексом $-1 < k < 0$
надо продифференцировать функцию с положительным индексом $0 < k < 1$. Для
нахождения функции ФД с индексом $-2 < k < -1$ надо продифференцировать
функцию $-1< k < 0$, т.е. дважды продифференцировать функцию с
положительным индексом $0 < k < 1$. Это рекуррентный процесс, т.е. для
каждого уменьшения индекса на единицу требуется лишний раз
продифференцировать функцию с положительным индексом. Поэтому следует
ожидать, что численное нахождение функции ФД с большими отрицательными
индексами будет связано с существенной потерей точности.

При $k = 0$ соотношение (\ref{eq:ref23}) теряет смысл: слева стоит производная от (2),
которая положительна и конечна при любом конечном $x$. Это означает, что
$I_{-1}(x) = \infty$ при любом значении $x$. Соответственно, не существует $I_k(x)$ при
любом целом $k < 0$.


\S \textbf{2.3 Ряд для $x < 0$}

% TODO: Пока непонятно, куда схему Горнера

Пусть $x > 0$. Поскольку в (5) под интегралом $t > 0$, то $\exp{x-t} < 1$ Тогда в
подынтегральном выражении (1) можно преобразовать дробь в сходящийся
ряд:
\begin{equation}
\frac{1}{1+e^{t-x}} = \frac{e^{x-t}}{1+e^{x-t}}=\sum_{n=1}^{\infty} (-1)^{n-1}e^{n(x-t)}.
\end{equation}
Умножим последнее выражение на $t^k$ и проинтегрируем. Интеграл от
$t^{k}exp(-nt)$ выражаeтся через $Г(k + 1)$. В итоге получаем следующий ряд [Stoner, McAougal]:
\begin{equation}
I_k(x)=\Gamma(k+1)\sum_{n-1}^{\infty} (-1)^{n-1}\frac{e^{nx}}{n^{k+1}},x<0.
\end{equation}
Этот ряд сходится при любых $x < 0$, но сходимость неравномерная: она быстро
ухудшается при $x \to -0$. Если $x = 0$, то ряд (5) сходится для индексов $k > -1$, но
сходимость при этом крайне медленная. При $x > 0$ ряд расходится для любого
$k$.

\textbf{Замечание.} Почленное дифференцирование ряда (5) с индексом k точно
дает ряд для индекса $k - 1$.


\S \textbf{2.4. Всюду сходящийся ряд}

Этот ряд был предложен в [Калиткин 68]. Применим к подынтегальному выражению
(1) следующее преобразование:
\begin{equation}
\frac{1}{1+e^{t-x}}=\frac{2e^{-t}}{(1+2e^{-x})-(1+2e^{-t})}=\frac{2e^{-t}}{1+2e^{-x}}\Bigg(1-\frac{1-2e^{-t}}{1+2e^{-x}}\Bigg)^{-1}=\frac{2e^{-t}}{1+2e^{-x}} \sum_{m=0}^{\infty} \Bigg(\frac{1-2e^{-t}}{1+2e^{-x}}\Bigg)^{m}.
\end{equation}
При допустимых значениях переменных $(-\infty < x < +\infty,0 < t < +\infty)$ разложение в
ряд здесь всегда сходится, так как $|(1-2e^{-t})/(1+2e^{+x})| < 1$. Подставляя
последнее разложение в интеграл (1), получаем ряд, сходящийся при любых x:
\begin{equation}
I_k(x)=2\Gamma(k+1)\sum_{n=0}^{\infty} \frac{b_n^{(k)}}{(1+2e^{-x})^{n+1}},
\label{eq:ref24}
\end{equation}
где
\begin{equation}
b_n^{(k)}=\frac{1}{\Gamma(k+1)}\int_0^{\infty} (1-2e^{-t})^ne^{-t}t^kdt=\sum_{p=0}^n \frac{(-1)^p2^pn!}{p!(n-p)!(p+1)^{k+1}};b_0^(k)=1.
\label{eq:ref25}
\end{equation}
Сумма в (\ref{eq:ref25}) получается раскрытием скобки в подынтегральном выражении по
формуле бинома и выражением получившихся интегралов через $\Gamma$ -функцию.

В подынтегральном выражении для $b_nk$ стоит скобка $(1-2e^{-t})$, которая по
модулю не превосходит 1; поэтому всегда $|b_n^{(k)}| \leqslant 1$.
Следовательно, ряд (8) сходится при любом x не медленней, чем геометрическая прогрессия со
знаменателем $(1+2e^{-x})^{-1}$. На любом ограниченном справа полубесконечном
интервале эта сходимость будет равномерной. Практически при $x \leqslant 0$, и даже
$x \leqslant 1$, сходимость достаточно быстрая, и ряд (8) удобен для прямых вычислений
функций ФД. Этим ряд (8) удобнее ряда (5), который практически пригоден
лишь при $x \leqslant -1$. Однако при $x > 1$ скорость сходимости ряда (8) быстро
ухудшается.

Отметим одно качественное отличие ряда (8) от ряда (5). Почленное
диффиренцирование ряда (8) для индекса $k$ не дает такого же ряда для индекса
$k=-1$.

\textbf{Коэффициенты ряда.} Вычисление $b_n^{(k)}$ с помощью суммы (9) легко
выполняется для первых членов ряда:
\begin{equation}
b_0^{(k)}=1;b_1^{(k)}=1-2^{-k}.
\end{equation}
Однако для больших n так вычислять коэффициенты из суммы (9) неудобно.
Слагаемые суммы знакопеременны. Члены суммы содержат в себе
биномиальные коэффициенты. При больших n центральные коэффициенты на
много порядков больше крайних коэффициентов. Поэтому суммирование
знакопеременных членов в (9) приводит к потере точности. Уже при $n~10$
теряется много значащих цифр, а при $n~20$ потеря точности становится
огромной.

Существует способ вычисления $b_n^{(k)}$ без потери точности. Справедливы
следующие рекуррентные соотношения, выражающие коэффициенты для
индекса $k$ через коэффициенты для индекса $k-1$:
\begin{equation}
b_0^{(k)}=1;b_n^{(k)}=\frac{1}{n+1}(b_n^{(k-1)}+nb_{n-1}^{(k)}),n>1.
\end{equation}

Равенство (11) проверяется интегрированием (9) по частям. Предполагая
$k > 0$ и умножая все на $\Gamma(k + 1)$, проинтегрируем сомножитель $e^{-t}$:
\begin{equation}
\Gamma(k+1)b_n^{(k)}=-(1-2e^{-t})^ne^{-t}t^k\Big|_0^{\infty} + \int_0^{\infty} e^{-t}\frac{d}{dt}[(1-2e^{-t})^nt^k]dt. 
\end{equation}
Первое слагаемое равно 0. Преобразуем подынтегральное выражение:
\begin{equation}
 e^{-t}\frac{d}{dt}[(1-2e^{-t})^nt^k]=ne^{-t}(1-2e^{-t})^{n-1}(2e^{-t})t^k+k(1-2e^{-t})^nt^{k-1}
\end{equation}
Выражение $(2e^{t})$  в первом слагаемом преобразуем так: $(2e^{t})= 1-(1-2e^{-t})$.
Тогда последний интеграл выражается через коэффициенты следующим
образом:
\begin{equation}
n\Gamma(k+1)b_{n-1}^{(k)}-n\Gamma(k+1)b_n^{(k)}+k\Gamma(k)b_n^{(k-1)}.
\end{equation}
Приравнивая полученное выражение величине $\Gamma{(k+1)}b_n^{(k)}$ , доказываем формулу (11).

Поскольку $|b_n^{(k)}| \leqslant 1$, а коэффициенты в правой части (11) суммируются с
положительными весами $1/(n + 1)$ и $n/(n + 1)$, причем сумма весов равна 1, то
вычисления по формуле (11) будут устойчивыми. Заметим, что если для
некоторого $k - 1$ коэффициенты $|b_n^{(k-1)}| \geqslant 0$ при всех n, то коэффициенты $b_n^{(k)}$ также будут неотрицательны. Поскольку при увеличении $k$ на 1 вычисления
устойчивы, то можно далее снова увеличить $k$ на 1 и повторить этот процесс
неограниченное количество раз, не теряя точности.

Заметим, что, рекуррентно суммируя (11) по $n$, получаем следующее выражение:
\begin{equation}
b_n^{(k)}=\frac{1}{n+1}\sum_{p=0}^n b_p^{(k-1)}
\end{equation}
Вычисление по формуле (12) также устойчиво.

Практически нас интересуют только целые или полуцелые индексы. Для
$k = 0$ коэффициенты вычисляются точно:
\begin{equation}
b_n^{(0)}=\frac{1+(-1)^n}{2(n+1)},n \geqslant 0;
\end{equation}
эта формула легко получается из интеграла (9) заменой переменных
$\tau = (1 - 2e^{-t})$. Заметим, что все нечетные коэффициенты (13) равны 0, а четные
положительны. Для других целых индексов $k > 0$ коэффициенты вычисляются
рекуррентным применением (11). Видно, что все они будут положительными. В
принципе, коэффициенты для целых $k$ выражаются через обыкновенные дроби,
но эти выражения чрезмерно громоздки.

Для полуцелых индексов $k$ наиболее удобно начать с индекса $k = -1/2$. В
этом случае в интеграле (9) удобно сделать замену $t = \tau^2$. Получившиеся
интегралы вычисляются по квадратурным формулам. По найденным
коэффициентам и рекуррентным формулам (11) легко вычисляются значения
коэффициентов для более высоких полуцелых индексов.

\textbf{Индекс $k = -3/2$.} Он требуется в практических приложениях. Формула
(11) очевидным образом обращается в сторону уменьшения индекса:
\begin{equation}
b_0^{(k)}=1;b_n^(k-1)=(n+1)b_n^{(k)}-nb_{n-1}^{(k)}, n > 1.
\end{equation}
Однако эта формула содержит вычитание с большими весами, и вычисления по
ней неустойчивы. Выгоднее воспользоваться дифференциальным
соотношением (4), полагая в нем $k = -1/2$, и продифференцировать ряд (8) для
этого индекса почленно. Это дает
\begin{equation}
I_{-\frac{3}{2}}(x)=-8\sqrt{\pi}e^{-x}\sum_{n=0}^{\infty} \frac{(n+1)b_n^{(-1/2)}}{(1+2e^{-x})^{n+2}}
\end{equation}
Этот ряд также сходится при любых $x$, а вычисления по этой формуле
устойчивы.

Коэффициенты для всех целых и полуцелых индексов от $k = -1/2$ до $k = 4$
приведены в Таблице 1 в виде десятичных дробей. Число значащих цифр
рассчитано на получение относительной точности $\epsilon = 10^{-16}$. Число
коэффициентов достаточно для вычисления функций ФД при $x \leqslant 1$ с указанной
точностью. Для значений $x \leqslant 0$ достаточно суммировать до $n = 35$.

%%% TODO: add tables
\input{ch2/chapter2coeff}

\S \textbf{2.5. Изменение знака аргумента}

В [4] получено фундаментальное соотношение, связывающее функции ФД
произвольного индекса $k > -1$ от положительного и отрицательного
аргументов. Запишем его в несколько преобразованном виде, предполагая
$x > 0$:
\begin{equation}
% Препринт 1 формула 15
\end{equation}
здесь $\zeta -$ функция от четного аргумента выражается через числа Бернулли:
\begin{equation}
% Препринт 1 формула 16
\end{equation}
Заметим, что при сравнении данных формул с [4] надо учитывать одно
обстоятельство: определение функции ФД в [4] отличается от (1) делителем $\Gamma(k + 1)$.

Представление (15) является асимптотическим. Это означает, что при
фиксированном $x$ и возрастании $N$, т.е. увеличении числа членов суммы,
точность сначала возрастает до некоторого номера $N(x)$, а при дальнейшем
добавлении членов начинает ухудшаться. Оптимальное $N(x)$ монотонно
возрастает при $x \to +\infty$. Таким образом, представление (15) позволяет получать
высокую точность при положительных $x >> 1$, но при умеренных $x > 0$ его
точность невелика.

Нетрудно убедиться, что почленное дифференцирование разложения (15)
дает разложение для функции ФД с индексом $k - 1$. Однако оптимальное
число членов $N(x)$ оказывается разным для функций соседних индексов.

В Таблице 2 приведены значения первых 12 чисел Бернулли и
$\zeta -$ функции. Такого количества достаточно для обеспечения относительной
погрешности $10^{16}$ при аргументах $x \geqslant 50$.

Таблица 2 %%%TODO
\textbf{Значения чисел Бернулли и $\zeta -$функции}

\textbf{Целые индексы.} Сам асимптотический ряд (15) был получен ещё в ранних
работах [3]. Однако там ещё не была обнаружена связь с функциями от
отрицательного аргумента. Для функций произвольного индекса последнее
обстоятельство несущественно, поскольку точность асимптотического ряда
хороша лишь при больших значениях $x$, когда величина $I_k(-x)$ весьма мала.

Однако для целых индексов $k \geqslant 0$ ситуация кардинально меняется. В этом
случае в произведении по $p$ сомножитель со значением $p = 2k + 2$ равен нулю.
Тем самым, сумма по n содержит лишь конечное число слагаемых вплоть до
$N=1+[k/2]$, где квадратные скобки обозначают целую часть числа. Поэтому
соотношение (15) принимает следующий вид:
\begin{equation}
% Препринт 1 формула 17
\end{equation}
Самое поразительное то, что для целых индексов соотношение (17) является не
асимптотическим, а точным! В этом можно убедиться следующим образом. Для
функции $I_0(x)$ оно совпадает с соотношением (3), которое является точным.
Полагая $k=1$ в (4), подставляя в правую часть (3) и интегрируя, получим для
функции $I_1(x)$ соотношение между функциями положительного и
отрицательного аргументов, которое также оказывается точным.
Последовательно повышая таким интегрированием индекс $k$ на единицу,
убедимся в том, что соотношение (17) является точным для всех функций
целого индекса.

Приведем такие соотношения для нескольких первых индексов:
\begin{equation}
 %Препринт 1 формула 18
\end{equation}
Этих значений $k$ достаточно для практических приложений.


\S \textbf{2.6. Интегральная функция ФД}

Эта функция определена соотношением (6). Исследуем свойства этой функции.

\textbf{Разложение при $x < 0.$} Запишем разложение (5) для индекса $k=-1/2$:
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Возводя этот ряд в квадрат и группируя члены с одинаковыми экспонентами, получим
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Почленно интегрируя полученный ряд от $-\infty$ до $x$, получим искомое
разложение:
\begin{equation}
% Препринт 1 раздел формула 20
\end{equation}
Это разложение сходится при $x < 0$ и расходится при $x > 0$. Сходимость тем
быстрее, чем больше модуль $x$. Ряд (20) знакопеременный. Фактически он
пригоден для вычисления функции (19) при $х \leqslant -1$, как и ряд (5). Значения
коэффициентов $a_n$ приведены в Таблице 3.

\textbf{Всюду сходящийся ряд.} Напишем всюду сходящийся ряд (8) для $k = -1/2$:
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Возводя этот ряд в квадрат и группируя члены с одинаковыми знаменателями, получим
\begin{equation}
% Препринт 1 формула 21
\end{equation}
Для получения $J(х)$ надо проинтегрировать (21) от $-\infty$ до $x$. Будем искать
интеграл в виде аналогичного разложения с неизвестными коэффициентами $c_n$:
\begin{equation}
% Препринт 1 формула 22
\end{equation}
Продифференцируем (22) по x и проведем следующие преобразования:
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Сдвигая во второй сумме индекс $n$ на 1, получим
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Сопоставляя последнее выражение с (21) и приравнивая коэффициенты при
одинаковых степенях знаменателя, найдем следующее соотношение между
коэффициентами:
\begin{equation}
%% Препринт 1 раздел 6 формула без номера
\end{equation}
Таким образом, коэффициенты формулы (22) определяются из рекуррентных соотношений
\begin{equation}
% Препринт 1 формула 23
\end{equation}
Значения коэффициентов n c приведены в Таблице 3.

Формулы (22)-(23) определяют ряд, сходящийся при любых значениях $x$.
Скорость его сходимости достаточно хороша при $x \leqslant 0$, удовлетворительна при
$x \leqslant 1$, но быстро ухудшается при $x > 1$.

\textbf{Разложение при $x \to +\infty$.} Запишем асимптотическое разложение (15) для
произвольного $k$ в более удобном виде:

%%% TODO: Таблица 3
\begin{table}[]
\caption{\textbf{Коэффициенты разложений функции J(x)}}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
$n$ & $a_n$ & $c_n$ & $C_n$ \\
\hline
0 & 0.50000000000000000 & 0.50000000000000000 & 1.00000000000000000 \\
1 & 0.47140452079103173 & 0.05719095841793650 & -0.82246703342411309 \\
2 & 0.41367513459481287 & 0.32627341363306145 & -3.38226010534730559 \\
3 & 0.36329931618554523 & 0.05555337454026419 & -56.74866767632004638 \\
4 & 0.32247788425329943 & 0.24658846860286468 & -2076.439816971693289 \\
5 & 0.28947176887871823 & 0.05073748578641944 & -133516.6239190830092 \\
6 & 0.26245962433780035 & 0.20002927599276679 & -13363920.49546855688 \\
7 & 0.24002748681137623 & 0.04624864575737019 & -1924202279.429788351 \\
8 & 0.22113507376025146 & 0.16919747074124367 & -376996608458.5720214 \\
9 & 0.20502010799708259 & 0.04243339943502982 &                       \\
10 & 0.19111818527221525 & 0.14714269473929523 &                      \\
11 & 0.17900522098810093 & 0.03922350305150957 &                      \\
12 & 0.16835758850494667 & 0.13051578228471081 &                      \\
13 & 0.15892459422501767 & 0.03650451326932291 &                      \\
14 & 0.15050930279877994 & 0.11749388727681387 &                      \\
15 & 0.14295500139265471 & 0.03417682128363331 &                      \\
16 & 0.13613550394070195 & 0.10699573032743079 &                      \\
17 & 0.12994810323070083 & 0.03216234704554120 &                      \\
18 & 0.12430837457100294 & 0.09833733348435542 &                      \\
19 & 0.11914629284901028 & 0.03040122425575591 &                      \\
20 & 0.11440329429976415 & 0.09106388018262407 &                      \\
21 & 0.11003002691122073 & 0.02884749082202021 &                      \\
22 & 0.10598460916982465 & 0.08486060243799427 &                      \\
23 & 0.10223126852657950 & 0.02746553440048496 &                      \\
24 & 0.09873926667442291 & 0.07950240515223343 &                      \\
25 & 0.09548204372438338 & 0.02622743720392143 &                      \\
26 & 0.09243653108215864 & 0.07482385935080225 &                      \\
27 & 0.08958259552832193 & 0.02511104569452402 &                      \\
28 & 0.08690258621471895 & 0.07070053682482372 &                      \\
29 & 0.08438096303764077 & 0.02409857188256913 &                      \\
30 & 0.08200398984235426 & 0.06703696772323861 &                      \\
31 & 0.07975947964440647 & 0.02317557364450819 &                      \\
32 &                     & 0.06375862474843785 &                      \\
33 &                     & 0.02233020393904351 &                      \\
34 &                     & 0.06080644154622106 &                      \\
\hline
\end{tabular}
\end{center}
\end{table}

\begin{equation}
% Препринт 1 формула 24
\end{equation}
Положим здесь $k = -1/2$; тогда $cos(\pi k) = 0$, и остается только сумма. Возведем
эту сумму в квадрат и опять сгруппируем члены по одинаковым степеням $х$.
Суммирование по $n$ идет не до бесконечности, а до $N$. Однако мы будем
пользоваться разложением (24) только в том случае, если последние члены
суммы достаточно малы по сравнению с главными. Тогда можно приближенно
записать
\begin{equation}
% Препринт 1 раздел 25
\end{equation}
Почленно проинтегрируем (25) по $x$ от $-\infty$ до $x$, учитывая значения
$C_0=1, A_1(-1/2)=-\pi^2/24, C_1=-pi^2/12$. Получим следующую сумму:
\begin{equation}
% Препринт 1 формула 26
\end{equation}
где $j$ есть константа, возникающая при интегрировании. Значение этой
константы приведено в [6-7]:
\begin{equation}
% Препринт 1 формула 27
\end{equation}
где $С = 0.5772156649015325...$ – константа Эйлера.

Медленно сходящуюся сумму (27) необходимо вычислить с точностью $\epsilon~10^{-16}$ .
Непосредственное суммирование на компьютере требует неприемлемо
большого числа членов ряда. Поэтому воспользуемся следующим приемом.
Разобъем бесконечную сумму на две:
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Первую сумму вычислим непосредственно; при этом суммировать будем с
последнего члена, т.к. проведение суммирования в порядке увеличения
слагаемых уменьшает ошибки округления. Вторую сумму рассмотрим, как
квадратуру средних для интеграла от функции $n^{-2}ln(n)$ в пределах
$N + 1/ 2 \leqslant n \leqslant +\infty$ с шагом $\delta n=1$. Сам интеграл легко вычисляется точно
заменой переменных $\xi=\ln n $ и равен:
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Для повышения точности добавим к формуле средних поправки Эйлера-
Маклорена, содержащие первую и третью производные подынтегральной
функции на левой границе (очевидно, эти поправки на правой границе
обращаются в нуль). Получим следующее выражение:
\begin{equation}
% Препринт 1 раздел 6 формула без номера
\end{equation}
Следующая поправка Эйлера-Маклорена есть $O(N^{-7})$; чтобы она не превышала
$10^{-16}$, достаточно взять $N = 300$. Численный расчет с этими значениями даёт
\begin{equation}
\sum ln = 0.93754825431584388,
j = 0.76740941382814898.
\end{equation}

Коэффициенты $C_n$ для $n \geqslant 2$ приведены в Таблице 3. Разложение (26)
имеет асимптотическую сходимость, так что суммировать по n можно только
до тех пор, пока члены суммы достаточно быстро убывают. Определение
оптимального числа членов $N$ является самостоятельной проблемой.